const b4a = require('b4a')

module.exports = deriveTopicKey

function deriveTopicKey ({ id, senderKey, feedKey, receiverKey, log }) {
  senderKey = Buffer.isBuffer(senderKey) ? senderKey : b4a.from(senderKey, 'hex')
	stringSender = senderKey.toString('hex') 

  feedKey = Buffer.isBuffer(feedKey) ? feedKey : b4a.from(feedKey, 'hex')
	stringfeed = feedKey.toString('hex') 

  receiverKey = Buffer.isBuffer(receiverKey) ? receiverKey : b4a.from(receiverKey, 'hex')
	stringreceiver = receiverKey.toString('hex') 

  id = id.toString()
  
  const concatinated = id + stringSender + stringfeed + stringreceiver
  const inbuff = b4a.from(concatinated, 'hex')
  // this is not a valid topic, but we don't use it to join swarm as we connect to the peers directly
  return inbuff 
}

