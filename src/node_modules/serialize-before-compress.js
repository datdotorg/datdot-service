const varint = require('varint')

module.exports = serialize_before_compress

function serialize_before_compress (data, pos) {
  const dataBuf = Buffer.from(data, 'binary')
  // Allocate buffer for the data that should be signed
  const to_compress = Buffer.alloc(dataBuf.length + varint.encodingLength(pos))
  // Write the index to the buffer that will be signed
  varint.encode(pos, to_compress, 0)
  // Copy the encoded data into the buffer that will be signed
  dataBuf.copy(to_compress, varint.encode.bytes)
  return to_compress
}