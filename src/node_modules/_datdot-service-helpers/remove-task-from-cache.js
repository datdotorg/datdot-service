module.exports = remove_task_from_cache

async function remove_task_from_cache ({ account, store, topic, log }) {
    return new Promise(async (resolve, reject) => {
        stringtopic = topic.toString('hex')
        if (account.cache.tasks[stringtopic]) { 
            log({ type: 'task', data: { text: 'Removing task for topic', tasks: account.cache.tasks[stringtopic] }})
            account.cache.tasks[stringtopic]--
            if (!account.cache.tasks[stringtopic] < 1) {
                await store.no_tasks({ stringtopic, log })
            }
            log({ type: 'task', data: { text: 'Task removed', tasks: account.cache.tasks[stringtopic] }})
            resolve()
        } else {
            log({ type: 'task', data: { text: 'Trying to remove a task for a non existing topic', stringtopic }})
            reject()
        }
    })
}