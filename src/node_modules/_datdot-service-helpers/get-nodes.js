const tree = require('flat-tree')

module.exports = get_nodes

async function get_nodes (feed, index, version) {
  const all = []
  const v = version * 2

  all.push(index*2)
  const roots = tree.fullRoots(v)
  all.push(...roots)
      
  const nodes = await Promise.all(all.map(index => feed.core.tree.get(index)))
  const proofs = await feed.core.tree.proof({ upgrade: { start: 0, length: index } })
  console.log('got the proofs', proofs)
  // nodes.push(...)

  return nodes

}