module.exports = refresh_discovery_mode

async function refresh_discovery_mode ({ account, feed, mode, log }) {
    return new Promise(async (resolve, reject) => {
        const stringtopic = feed.discoveryKey.toString('hex')
        const discovery = account.cache.topics[stringtopic].discovery
        if (discovery) { 
            discovery.refresh(mode)
            log({ type: 'discovery', data: { text: 'Refreshed the discovery mode', feed: feed.key.toString('hex'), mode }})
            // console.log({ discovery: storage.discovery })
            resolve()
        } else {
            log({ type: 'feed', data: { text: 'Trying to refresh discovery of a non existing feed', feed: feed.key.toString('hex') }})
            reject()
        }
    })
}