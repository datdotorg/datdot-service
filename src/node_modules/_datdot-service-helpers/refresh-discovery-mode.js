module.exports = refresh_discovery_mode

async function refresh_discovery_mode ({ account, feedkey, mode, log }) {
    return new Promise(async (resolve, reject) => {
        const stringkey = feedkey.toString('hex')
        if (account.storages.has(stringkey)) { 
            const storage = account.storages.get(stringkey)
            await storage.discovery.refresh(mode)
            log({ type: 'discovery', data: { text: 'Refreshed the discovery mode', feed: stringkey, mode }})
            // console.log({ discovery: storage.discovery })
            resolve()
        } else {
            log({ type: 'feed', data: { text: 'Trying to refresh discovery of a non existing feed', stringkey }})
            reject()
        }
    })
}