module.exports = refresh_discovery_mode

async function refresh_discovery_mode ({ swarm, topic, mode, log }) {
	return new Promise(async (resolve, reject) => {
		try {
			log({ type: 'discovery', data: { text: 'Refreshing the discovery mode', topic: topic.toString('hex'), mode }})
			const discovery = swarm.status(topic)
			if (discovery) { 
				discovery.refresh(mode)
				log({ type: 'discovery', data: { text: 'Refreshed the discovery mode', topic: topic.toString('hex'), mode }})
				// console.log({ discovery: storage.discovery })
				resolve()
			} else {
				log({ type: 'feed', data: { text: 'Trying to refresh discovery of a non existing topic', topic: topic.toString('hex') }})
				reject()
			}
		} catch (err) {
			log({ type: 'Error', data: { text: 'Error: in refreshing discovery mode', err }})
		}
	})
}