const { once, promisifyMethod } = require('nonsynchronous')

module.exports = destroyAll

async function destroyAll (swarm) {
  promisifyMethod(swarm, 'listen')
  await swarm.listen()
  is(typeof swarm.address().port, 'number')
  swarm.destroy()
  await once(swarm, 'close')
}